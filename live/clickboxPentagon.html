<!DOCTYPE html>
<html lang="en" onmousedown="MouseDown()" onmouseup="MouseUp()" onmouseleave="MouseExit()" oncontextmenu="return false;">
  <head>
     <script src="javascript.js"></script>
    <link rel="stylesheet" href="css/clickboxStyles.css">  
    <script>	  
class PentagonButton extends GameButton {
	constructor(x, y, Facing) {
	  	super(x, y, Facing); 
        this.btn.maxClicks = 2;		
		this.btn.svgBg.classList.add("triangle");
		this.btn.svgL.classList.add("triangle");
		this.btn.classList.add("triangle");
		this.btn.svgL.setAttribute("viewBox", "-20 -25 120 120");
		if (Facing == "down") {
		  this.btn.svgBg.style.transform = "translate(" + x + "px," + y + "px)" + "rotate(180deg)";
		  this.btn.style.transform = "translate(" + (x + 1) + "px,"+ (y - 7) + "px)";	
		  this.btn.svgM.style.transform = "translate(" + (x + 1) + "px,"+ (y - 7) + "px)";	
		  this.btn.svgL.style.transform = "translate(" + x + "px," + (y + 1) + "px)" + "rotate(180deg)";
		} else if (Facing == "right") {
		  this.btn.svgBg.style.transform = "translate(" + x + "px," + y + "px)" + "rotate(90deg)";
		  this.btn.style.transform = "translate(" + (x - 6) + "px,"+ y + "px)";	
		  this.btn.svgM.style.transform = "translate(" + (x - 6) + "px,"+ y + "px)";
		  this.btn.svgL.style.transform = "translate(" + (x + 1) + "px," + y + "px)" + "rotate(90deg)";
		} else if (Facing == "left") {
		  this.btn.svgBg.style.transform = "translate(" + x + "px," + y + "px)" + "rotate(270deg)";
		  this.btn.style.transform = "translate(" + (x + 7) + "px,"+ y + "px)";	
		  this.btn.svgM.style.transform = "translate(" + (x + 7) + "px,"+ y + "px)";
		  this.btn.svgL.style.transform = "translate(" + (x - 2) + "px," + y + "px)" + "rotate(270deg)";
		} else {
		  this.btn.style.transform = "translate(" + x + "px,"+ (y + 8) + "px)";	
		  this.btn.svgM.style.transform = "translate(" + (x + 1) + "px,"+ (y + 8) + "px)";
		  this.btn.svgL.style.transform = "translate(" + x + "px," + (y - 1) + "px)";	
		}
	}

    createHitbox(svg, hitbox) {
	    let point = svg.createSVGPoint();
	    point.x = 40;
	    point.y = 1;
	    hitbox.points.appendItem(point);
	    point = svg.createSVGPoint();
	    point.x = 79;
	    point.y = 40;
	    hitbox.points.appendItem(point);
	    point = svg.createSVGPoint();
	    point.x = 79;
	    point.y = 79;
	    hitbox.points.appendItem(point);
	    point = svg.createSVGPoint();			
	    point.x = 1;
	    point.y = 79;
	    hitbox.points.appendItem(point);
	    point = svg.createSVGPoint();	
	    point.x = 1;
	    point.y = 40;
	    hitbox.points.appendItem(point);
	    point = svg.createSVGPoint();			
	}

    defineArea() {
	    let midBtn = this.btn
        let n = 85;
        let e = 85;
        let s = 85;
        let w = 85;
		if (midBtn.walls.includes("n")) { // the presence of a wall will limit the area on that side
		    n = 5;
		}
		if (midBtn.walls.includes("e")) {
		    e = 5;
		}
		if (midBtn.walls.includes("s")) {
		    s = 5;
		}
		if (midBtn.walls.includes("w")) {
		    w = 5;
		}
	    for (let i = 0; i < GameButtons.length; i++) {
		    let btn = GameButtons[i].btn;
		    if (btn.offsetx < midBtn.offsetx + e &&
		        btn.offsetx > midBtn.offsetx - w &&
			    btn.offsety < midBtn.offsety + s &&
			    btn.offsety > midBtn.offsety - n) {
              midBtn.affectedButtons.push(btn);
		    }
		  }
		for (let c = 0; c < CycleButtons.length; c++) {
			let cbtn = CycleButtons[c].btn;
		    if (cbtn.offsetx < midBtn.offsetx + e &&
		        cbtn.offsetx > midBtn.offsetx - w &&
			    cbtn.offsety < midBtn.offsety + s &&
			    cbtn.offsety > midBtn.offsety - n) {
              midBtn.affectedButtons.push(cbtn.counterpart.btn);
		    }		
	    }		
	}
	
    createModifier(modifier) {
        modifier.setAttribute("r","15px");
        modifier.setAttribute("cx","40px");
        modifier.setAttribute("cy","40px");		
	}	
	
    createHitboxOld(svg, hitbox) {             //////////////////////////////////////// DEPRICATED
	    let point = svg.createSVGPoint();
	    point.x = 30;
	    point.y = 1;
	    hitbox.points.appendItem(point);
	    point = svg.createSVGPoint();
	    point.x = 59;
	    point.y = 30;
	    hitbox.points.appendItem(point);
	    point = svg.createSVGPoint();
	    point.x = 59;
	    point.y = 59;
	    hitbox.points.appendItem(point);
	    point = svg.createSVGPoint();			
	    point.x = 1;
	    point.y = 59;
	    hitbox.points.appendItem(point);
	    point = svg.createSVGPoint();	
	    point.x = 1;
	    point.y = 30;
	    hitbox.points.appendItem(point);
	    point = svg.createSVGPoint();			
	}
	
}	  
	  
      function GenerateLevelNum (Level) {
	    if (Level == 1) {                              //////////////////////////////////////////////////////////// Level 1
		  GenerateLevel (size*size/3);                 //////////////////////////////////////////////////////////// Level 1
	    } else if (Level == 2) {                       //////////////////////////////////////////////////////////// Level 2
		  GenerateLevel (size*size/1.5);                 //////////////////////////////////////////////////////////// Level 2
	    } else if (Level == 3) {                       //////////////////////////////////////////////////////////// Level 3
		  GenerateLevel (size*size);                 //////////////////////////////////////////////////////////// Level 3
		} else {
		  InitializeButtonGroups();
		}	
	  }
	  
	  function NewLevel(){
	    let i = 0;
		let xOffset = 0;
		let yOffset = 0;
        DestroyGrid();
		let grid = document.createElement ('div');
		grid.id = "grid-container";
		document.getElementById("demo").appendChild(grid);
		document.getElementById("new-level").innerHTML = "New Level";
		if (parseInt(document.getElementById("level-size").value) < 3){
		  document.getElementById("level-size").value = 3;
		}
		if (parseInt(document.getElementById("level-size").value) > 30){
		  document.getElementById("level-size").value = 30;
		}
	  	size = parseInt(document.getElementById("level-size").value);  	
	    for (let y = 0; y < size; y++) {
          if (y%2 == 0) {
		    xOffset = 30;
		  } else {
		    xOffset = 0;
		  }
          for (let x = 0; x < size; x++){
            i++;	 			
	        GameButtons.push(new HexagonButton(-30*size + 60*x + xOffset, y*45 + yOffset));
	      }  
	      x = 0;
        }	
		GenerateLevelNum (document.getElementById("level-number").value);
		document.getElementById("dummy").style.height = size*60 + "px";
      }
	  
      function GenerateLevelNum (Level) {
	    if (Level == 1) {                              //////////////////////////////////////////////////////////// Level 1
		  GenerateLevel (size*size/3);                 //////////////////////////////////////////////////////////// Level 1
	    } else if (Level == 2) {                       //////////////////////////////////////////////////////////// Level 2
		  GenerateLevel (size*size/1.5);                 //////////////////////////////////////////////////////////// Level 2
	    } else if (Level == 3) {                       //////////////////////////////////////////////////////////// Level 3
		  GenerateLevel (size*size);                 //////////////////////////////////////////////////////////// Level 3
		} else {
		  InitializeButtonGroups();
		}	
	  }
	  
	  function NewLevel(){
	    let i = 0;
		let type = "";
		let xOffset = 0;
		let yOffset = 0;
        DestroyGrid();
		let grid = document.createElement ('div');
		grid.id = "grid-container";
		document.getElementById("demo").appendChild(grid);
		document.getElementById("new-level").innerHTML = "New Level";
		if (parseInt(document.getElementById("level-size").value) < 3){
		  document.getElementById("level-size").value = 3;
		}
		if (parseInt(document.getElementById("level-size").value) > 30){
		  document.getElementById("level-size").value = 30;
		}
	  	size = parseInt(document.getElementById("level-size").value);  	
	    for (let y = 0; y < size; y++) {	
          for (let x = 0; x < size; x++){
            i++;	    
			
	        if (x%2 == 0 &&
			    y%2 == 0) { 
              type = "down";
			  xOffset = 0;
			  yOffset = 20;
	        } else if (x%2 == 1 &&
			           y%2 == 0) {
              type = "up";
			  xOffset = 0;
			  yOffset = -20;
	        } else if (x%2 == 0 &&
			           y%2 == 1) {
              type = "right";
			  xOffset = -40;
			  yOffset = 0;
	        } else {
              type = "left";
			   xOffset = -40;
			   yOffset = 0;
			}               
			
            if ((y)%4 == 0) {
			  if (type == "down") {
			    type = "up";
				yOffset = -20;
			  } else if (type == "up") {
			    type = "down";
				yOffset = 20;
			  }
			}
			
            if ((y-1)%4 == 0) {
			  if (type == "right") {
			    type = "left";
			  } else if (type == "left") {
			    type = "right";
			  }
			}
	          GameButtons.push(new PentagonButton(-40*size + 80*x + xOffset, y*60 + yOffset, type));
	      }  
	      x = 0;
        }	
		GenerateLevelNum (document.getElementById("level-number").value);
		document.getElementById("dummy").style.height = size*60 + "px";
      }
 
	</script>
	
  </head>
  <body>
    <main>
	  	  
	  <nav class="menu">
        <div>
           <span class="menu-button"><a href="index.html">Square</a></span>
		   <span class="menu-button"><a href="clickboxTriangle.html">Triangle</a></span>
		   <span><strong>Pentagon</strong></span>
		   <span class="menu-button"><a href="clickboxHexagon.html">Hexagon</a></span>
        </div>
      </nav>	  
	  
	  
	<div id="demo" class="demo">
	  <div>
	    <input type="number" class="level-number" id="level-number" value="1" min="1" max="3">
	    <button class="new-level" id="new-level" onclick="NewLevel()" >New Level</button>
	    <input type="number" class="level-size" id="level-size" value="5" min="3" max="30">
	  </div>
      <div><button class="reset" onclick="ResetClick()">Reset</button></div>
	</div>
	<div id="dummy"></div>	  
    </main>
	
	
	<script>

	NewLevel();
	  
	</script>  	
	
	
  </body>
</html>
