<!DOCTYPE html>
<html lang="en" onmousedown="MouseDown()" onmouseup="MouseUp()" onmouseleave="MouseExit()" oncontextmenu="return false;">
  <head>
     <script src="javascript.js"></script>
    <link rel="stylesheet" href="css/clickboxStyles.css">  
    <script>	  
class PentagonButton extends GameButton {
	constructor(x, y, Facing) {
	  	super(x, y, Facing); 
        this.maxClicks = 2;		
		
		if (Facing == "down") {
		    this.svgL.setAttribute("viewBox", "-25 -20 150 150");
		} else if (Facing == "right") {
		    this.svgL.setAttribute("viewBox", "-20 -25 150 150");
		} else if (Facing == "left") {
		    this.svgL.setAttribute("viewBox", "-30 -25 150 150");
		} else {
		    this.svgL.setAttribute("viewBox", "-25 -30 150 150");
		}
	}

    createHitbox(svg, hitbox) {
	    if (this.facing == "up") {
		    AddSVGPoint(svg, hitbox, 50, 1);
		    AddSVGPoint(svg, hitbox, 99, 50);
		    AddSVGPoint(svg, hitbox, 99, 99);
		    AddSVGPoint(svg, hitbox, 1, 99);
		    AddSVGPoint(svg, hitbox, 1, 50);			
		} else if (this.facing == "down") {
		    AddSVGPoint(svg, hitbox, 50, 99);
		    AddSVGPoint(svg, hitbox, 99, 50);
		    AddSVGPoint(svg, hitbox, 99, 1);
		    AddSVGPoint(svg, hitbox, 1, 1);
		    AddSVGPoint(svg, hitbox, 1, 50);			
		} else if (this.facing == "left") {
		    AddSVGPoint(svg, hitbox, 1, 50);
		    AddSVGPoint(svg, hitbox, 50, 99);
		    AddSVGPoint(svg, hitbox, 99, 99);
		    AddSVGPoint(svg, hitbox, 99, 1);
		    AddSVGPoint(svg, hitbox, 50, 1);		
		} else if (this.facing == "right") {
		    AddSVGPoint(svg, hitbox, 99, 50);
		    AddSVGPoint(svg, hitbox, 50, 99);
		    AddSVGPoint(svg, hitbox, 1, 99);
		    AddSVGPoint(svg, hitbox, 1, 1);
		    AddSVGPoint(svg, hitbox, 50, 1);			
		}
	}

    createModifier(modifier) {
	    if (this.facing == "down") {
            modifier.setAttribute("r","20px");
            modifier.setAttribute("cx","51px");
            modifier.setAttribute("cy","40px");				
		} else if (this.facing == "left") {
            modifier.setAttribute("r","20px");
            modifier.setAttribute("cx","61px");
            modifier.setAttribute("cy","50px");				
		} else if (this.facing == "right") {
            modifier.setAttribute("r","20px");
            modifier.setAttribute("cx","41px");
            modifier.setAttribute("cy","50px");				
		} else {
            modifier.setAttribute("r","20px");
            modifier.setAttribute("cx","51px");
            modifier.setAttribute("cy","60px");				
		}	    
	
	}

    createText(value) {
	    if (this.facing == "down") {
            value.setAttribute("x","51%");
            value.setAttribute("y","50%");			
		} else if (this.facing == "left") {
            value.setAttribute("x","61%");
            value.setAttribute("y","60%");			
		} else if (this.facing == "right") {
            value.setAttribute("x","41%");
            value.setAttribute("y","60%");			
		} else {
            value.setAttribute("x","51%");
            value.setAttribute("y","70%");			
		}
		value.setAttribute("font-size", "32px");
	}

    defineArea() {
	    let midBtn = this;
        let n = 105;
        let e = 105;
        let s = 105;
        let w = 105;
		if (midBtn.walls.includes("n")) { // the presence of a wall will limit the area on that side
		    n = 5;
		}
		if (midBtn.walls.includes("e")) {
		    e = 5;
		}
		if (midBtn.walls.includes("s")) {
		    s = 5;
		}
		if (midBtn.walls.includes("w")) {
		    w = 5;
		}
	    for (let i = 0; i < GameButtons.length; i++) {
		    let btn = GameButtons[i];
		    if (btn.offsetx < midBtn.offsetx + e &&
		        btn.offsetx > midBtn.offsetx - w &&
			    btn.offsety < midBtn.offsety + s &&
			    btn.offsety > midBtn.offsety - n) {
              midBtn.affectedButtons.push(btn);
		    }
		  }
		for (let c = 0; c < CycleButtons.length; c++) {
			let cbtn = CycleButtons[c];
		    if (cbtn.offsetx < midBtn.offsetx + e &&
		        cbtn.offsetx > midBtn.offsetx - w &&
			    cbtn.offsety < midBtn.offsety + s &&
			    cbtn.offsety > midBtn.offsety - n) {
              midBtn.affectedButtons.push(cbtn.counterpart);
		    }		
	    }		
	}	
	
}	  
	  
      function GenerateLevelNum (Level) {
	    if (Level == 1) {                              //////////////////////////////////////////////////////////// Level 1
		  GenerateLevel (size*size/3);                 //////////////////////////////////////////////////////////// Level 1
	    } else if (Level == 2) {                       //////////////////////////////////////////////////////////// Level 2
		  GenerateLevel (size*size/1.5);                 //////////////////////////////////////////////////////////// Level 2
	    } else if (Level == 3) {                       //////////////////////////////////////////////////////////// Level 3
		  GenerateLevel (size*size);                 //////////////////////////////////////////////////////////// Level 3
		} else {
		  InitializeButtonGroups();
		}	
	  }
	  
	  function NewLevel(){
	    let i = 0;
		let xOffset = 0;
		let yOffset = 0;
        DestroyGrid();
		let grid = document.createElement ('div');
		grid.id = "grid-container";
		document.getElementById("demo").appendChild(grid);
		document.getElementById("new-level").innerHTML = "New Level";
		if (parseInt(document.getElementById("level-size").value) < 3){
		  document.getElementById("level-size").value = 3;
		}
		if (parseInt(document.getElementById("level-size").value) > 30){
		  document.getElementById("level-size").value = 30;
		}
	  	size = parseInt(document.getElementById("level-size").value);  	
	    for (let y = 0; y < size; y++) {
          if (y%2 == 0) {
		    xOffset = 30;
		  } else {
		    xOffset = 0;
		  }
          for (let x = 0; x < size; x++){
            i++;	 			
	        GameButtons.push(new HexagonButton(-30*size + 60*x + xOffset, y*45 + yOffset));
	      }  
	      x = 0;
        }	
		GenerateLevelNum (document.getElementById("level-number").value);
		document.getElementById("dummy").style.height = size*60 + "px";
      }
	  
      function GenerateLevelNum (Level) {
	    if (Level == 1) {                              //////////////////////////////////////////////////////////// Level 1
		  GenerateLevel (size*size/3);                 //////////////////////////////////////////////////////////// Level 1
	    } else if (Level == 2) {                       //////////////////////////////////////////////////////////// Level 2
		  GenerateLevel (size*size/1.5);                 //////////////////////////////////////////////////////////// Level 2
	    } else if (Level == 3) {                       //////////////////////////////////////////////////////////// Level 3
		  GenerateLevel (size*size);                 //////////////////////////////////////////////////////////// Level 3
		} else {
		  InitializeButtonGroups();
		}	
	  }
	  
	  function NewLevel(){
	    let i = 0;
		let type = "";
		let xOffset = 0;
		let yOffset = 0;
        DestroyGrid();
		document.getElementById("new-level").innerHTML = "New Level";
		if (parseInt(document.getElementById("level-size").value) < 3){
		  document.getElementById("level-size").value = 3;
		}
		if (parseInt(document.getElementById("level-size").value) > 30){
		  document.getElementById("level-size").value = 30;
		}
	  	size = parseInt(document.getElementById("level-size").value);
		let grid = document.createElementNS("http://www.w3.org/2000/svg", 'svg');
	  	size = parseInt(document.getElementById("level-size").value); 
		grid.setAttribute("viewBox", "0 0 " + (size + 2)*100 + " " + (size + 2)*75);
		grid.style.width = "100%";
		grid.style.height = "auto";
		grid.id = "grid-container";	
		document.getElementById("demo").appendChild(grid);				
	    for (let y = 0; y < size; y++) {	
          for (let x = 0; x < size; x++){
            i++;	    
			
	        if (x%2 == 0 &&
			    y%2 == 0) { 
              type = "down";
			  xOffset = 0;
			  yOffset = 25;
	        } else if (x%2 == 1 &&
			           y%2 == 0) {
              type = "up";
			  xOffset = 0;
			  yOffset = -25;
	        } else if (x%2 == 0 &&
			           y%2 == 1) {
              type = "right";
			  xOffset = -50;
			  yOffset = 0;
	        } else {
              type = "left";
			   xOffset = -50;
			   yOffset = 0;
			}               
			
            if ((y)%4 == 0) {
			  if (type == "down") {
			    type = "up";
				yOffset = -25;
			  } else if (type == "up") {
			    type = "down";
				yOffset = 25;
			  }
			}
			
            if ((y-1)%4 == 0) {
			  if (type == "right") {
			    type = "left";
			  } else if (type == "left") {
			    type = "right";
			  }
			}
	          GameButtons.push(new PentagonButton(100*x + xOffset + 125, y*75 + yOffset + 75, type));
	      }  
	      x = 0;
        }	
		GenerateLevelNum (document.getElementById("level-number").value);
      }
 
	</script>
	
  </head>
  <body>
    <main>
	  	  
    <div class="dropdown">
      <button class="dropbtn">Menu</button>
      <div class="dropdown-content">
        <a href="index.html">Square</a>
        <a href="clickboxTriangle.html">Triangle</a>
        <a href="clickboxHexagon.html">Hexagon</a>
        <a href="clickboxPentagon.html">Pentagon</a>
      </div>
    </div>  
	  
	<div id="demo" class="demo">
	  <div>
	    <div class="level-num-div">
		  <p class="size-num-text">Number</p>
	      <input type="number" class="level-number" id="level-number" value="1" min="-18" max="18">		
		</div>
	    <button class="new-level" id="new-level" onclick="NewLevel()" >New Level</button>
		<div class="level-size-div">
		  <p class="size-num-text">Size</p>
	      <input type="number" class="level-size" id="level-size" value="5" min="3" max="30">		
		</div>
	  </div>
      <div><button class="reset" onclick="ResetClick()">Reset</button></div>
	</div>
	<div class ="bottom">
      <button id="press" class="press" ontouchstart="PressTouch(this)">Press</button>
      <button id="lock" class="lock" ontouchstart="LockTouch(this)">Lock</button>
	</div>
    </main>
	
	
	<script>

	NewLevel();
	  
	</script>  	
	
	
  </body>
</html>
